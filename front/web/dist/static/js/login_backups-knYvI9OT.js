import{_ as j,b as A,u as D,a as F,g as L,r as m,w as O,d,c as v,o as p,f as r,e as _,h as a,s as P,t as k,x as Q,j as s,k as V,n as C,m as T,p as $,q as l}from"./index-VkklmaQD.js";import{d as G,e as H}from"./jsencrypt-CjGg_tOm.js";const J={class:"login"},W={class:"title"},X={class:"login-code"},Y=["src"],Z={key:0},ee={key:1},oe={key:0,style:{float:"right"}},se={__name:"login_backups",setup(te){const M="实验室科研管理系统",q=A(),h=D(),R=F(),{proxy:U}=L(),o=m({username:"admin",password:"admin123",rememberMe:!1,code:"",uuid:""}),B={username:[{required:!0,trigger:"blur",message:"请输入您的账号"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]},w=m(""),g=m(!1),f=m(!0),z=m(!1),x=m(void 0);O(h,t=>{x.value=t.query&&t.query.redirect},{immediate:!0});function y(){U.$refs.loginRef.validate(t=>{t&&(g.value=!0,o.value.rememberMe?(l.set("username",o.value.username,{expires:30}),l.set("password",H(o.value.password),{expires:30}),l.set("rememberMe",o.value.rememberMe,{expires:30})):(l.remove("username"),l.remove("password"),l.remove("rememberMe")),q.login(o.value).then(()=>{const e=h.query,n=Object.keys(e).reduce((c,i)=>(i!=="redirect"&&(c[i]=e[i]),c),{});R.push({path:x.value||"/",query:n})}).catch(()=>{g.value=!1,f.value&&b()}))})}function b(){$().then(t=>{f.value=t.captchaEnabled===void 0?!0:t.captchaEnabled,f.value&&(w.value="data:image/gif;base64,"+t.img,o.value.uuid=t.uuid)})}function E(){const t=l.get("username"),e=l.get("password"),n=l.get("rememberMe");o.value={username:t===void 0?o.value.username:t,password:e===void 0?o.value.password:G(e),rememberMe:n===void 0?!1:!!n}}return b(),E(),(t,e)=>{const n=d("svg-icon"),c=d("el-input"),i=d("el-form-item"),N=d("el-checkbox"),I=d("el-button"),K=d("router-link"),S=d("el-form");return p(),v("div",J,[r(S,{ref:"loginRef",model:s(o),rules:B,class:"login-form"},{default:a(()=>[_("h3",W,Q(s(M)),1),r(i,{prop:"username"},{default:a(()=>[r(c,{modelValue:s(o).username,"onUpdate:modelValue":e[0]||(e[0]=u=>s(o).username=u),type:"text",size:"large","auto-complete":"off",placeholder:"账号"},{prefix:a(()=>[r(n,{"icon-class":"user",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),r(i,{prop:"password"},{default:a(()=>[r(c,{modelValue:s(o).password,"onUpdate:modelValue":e[1]||(e[1]=u=>s(o).password=u),type:"password",size:"large","auto-complete":"off",placeholder:"密码",onKeyup:V(y,["enter"])},{prefix:a(()=>[r(n,{"icon-class":"password",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),s(f)?(p(),P(i,{key:0,prop:"code"},{default:a(()=>[r(c,{modelValue:s(o).code,"onUpdate:modelValue":e[2]||(e[2]=u=>s(o).code=u),size:"large","auto-complete":"off",placeholder:"验证码",style:{width:"63%"},onKeyup:V(y,["enter"])},{prefix:a(()=>[r(n,{"icon-class":"validCode",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"]),_("div",X,[_("img",{src:s(w),onClick:b,class:"login-code-img"},null,8,Y)])]),_:1})):k("",!0),r(N,{modelValue:s(o).rememberMe,"onUpdate:modelValue":e[3]||(e[3]=u=>s(o).rememberMe=u),style:{margin:"0px 0px 25px 0px"}},{default:a(()=>e[4]||(e[4]=[C("记住密码")])),_:1,__:[4]},8,["modelValue"]),r(i,{style:{width:"100%"}},{default:a(()=>[r(I,{loading:s(g),size:"large",type:"primary",style:{width:"100%"},onClick:T(y,["prevent"])},{default:a(()=>[s(g)?(p(),v("span",ee,"登 录 中...")):(p(),v("span",Z,"登 录"))]),_:1},8,["loading"]),s(z)?(p(),v("div",oe,[r(K,{class:"link-type",to:"/register"},{default:a(()=>e[5]||(e[5]=[C("立即注册")])),_:1,__:[5]})])):k("",!0)]),_:1})]),_:1},8,["model"]),e[6]||(e[6]=_("div",{class:"el-login-footer"},[_("span",null,"Copyright © 2018-2026 ruoyi.vip All Rights Reserved.")],-1))])}}},le=j(se,[["__scopeId","data-v-cfe59531"]]);export{le as default};
