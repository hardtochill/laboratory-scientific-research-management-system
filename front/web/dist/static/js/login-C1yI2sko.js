import{_ as V,b as U,u as B,a as E,g as I,r as i,w as K,d as _,c as N,o as j,e as t,f as w,h,i as d,j as a,v,k as x,l as G,m as S,n as T,p as D,q as n}from"./index-VkklmaQD.js";import{d as F,e as L}from"./jsencrypt-CjGg_tOm.js";const O="/static/png/logo-CyBGpwGI.png",P={class:"container"},Q={class:"panel"},$={class:"input"},z={class:"input"},A={class:"input"},H=["src"],J={class:"remember"},W={__name:"login",setup(X){const C=U(),f=B(),M=E(),{proxy:k}=I(),s=i({username:"admin",password:"admin123",rememberMe:!1,code:"",uuid:""}),q={username:[{required:!0,trigger:"blur",message:"请输入您的账号"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]},g=i(""),b=i(!1),m=i(!0);i(!1);const y=i(void 0);K(f,o=>{y.value=o.query&&o.query.redirect},{immediate:!0});function p(){k.$refs.loginRef.validate(o=>{o&&(b.value=!0,s.value.rememberMe?(n.set("username",s.value.username,{expires:30}),n.set("password",L(s.value.password),{expires:30}),n.set("rememberMe",s.value.rememberMe,{expires:30})):(n.remove("username"),n.remove("password"),n.remove("rememberMe")),C.login(s.value).then(()=>{const e=f.query,l=Object.keys(e).reduce((u,r)=>(r!=="redirect"&&(u[r]=e[r]),u),{});M.push({path:y.value||"/",query:l})}).catch(()=>{b.value=!1,m.value&&c()}))})}function c(){D().then(o=>{m.value=o.captchaEnabled===void 0?!0:o.captchaEnabled,m.value&&(g.value="data:image/gif;base64,"+o.img,s.value.uuid=o.uuid)})}function R(){const o=n.get("username"),e=n.get("password"),l=n.get("rememberMe");s.value={username:o===void 0?s.value.username:o,password:e===void 0?s.value.password:F(e),rememberMe:l===void 0?!1:!!l}}return c(),R(),(o,e)=>{const l=_("el-button"),u=_("el-form");return j(),N("div",P,[t("div",Q,[e[9]||(e[9]=t("div",{class:"panel-header"},[t("div",{class:"panel-header-logo"},[t("img",{src:O})]),t("h1",{class:"panel-header-title"},"实验室科研管理系统 ")],-1)),w(u,{class:"form",ref:"loginRef",model:a(s),rules:q},{default:h(()=>[t("div",$,[e[4]||(e[4]=t("i",{class:"iconfont icon-RectangleCopy"},null,-1)),d(t("input",{type:"text",class:"input-field",placeholder:"请输入用户名","onUpdate:modelValue":e[0]||(e[0]=r=>a(s).username=r)},null,512),[[v,a(s).username]])]),t("div",z,[e[5]||(e[5]=t("i",{class:"iconfont icon-RectangleCopy2"},null,-1)),d(t("input",{type:"password",class:"input-field",placeholder:"请输入密码","onUpdate:modelValue":e[1]||(e[1]=r=>a(s).password=r),onKeyup:x(p,["enter"])},null,544),[[v,a(s).password]])]),t("div",A,[e[6]||(e[6]=t("i",{class:"iconfont icon-RectangleCopy1"},null,-1)),d(t("input",{type:"text",class:"input-field",placeholder:"请输入验证码","onUpdate:modelValue":e[2]||(e[2]=r=>a(s).code=r),onKeyup:x(p,["enter"])},null,544),[[v,a(s).code]]),t("img",{src:a(g),onClick:c},null,8,H)]),t("div",J,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=r=>a(s).rememberMe=r),name:"",id:"remember",value:""},null,512),[[G,a(s).rememberMe]]),e[7]||(e[7]=t("label",{for:"remember"},"记住密码",-1))]),w(l,{class:"input-submit",onClick:S(p,["prevent"])},{default:h(()=>e[8]||(e[8]=[T("登录")])),_:1,__:[8]})]),_:1},8,["model"])])])}}},ee=V(W,[["__scopeId","data-v-a5a4f356"]]);export{ee as default};
